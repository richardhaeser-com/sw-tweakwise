const b='{% block sw_cms_block_tweakwise_cross_selling %} <div class="sw-cms-block-tweakwise-cross-selling"> <slot name="products">{% block sw_cms_block_tweakwise_cross_selling_products %}{% endblock %}</slot> </div> {% endblock %}';Shopware.Component.register("sw-cms-block-tweakwise-cross-selling",{template:b});const v='{% block sw_cms_block_tweakwise_cross_selling_preview %} <div class="sw-cms-preview-tweakwise-cross-selling"> <sw-icon name="regular-chevron-left" size="20" /> <div class="sw-cms-preview-tweakwise-cross-selling__product-box"> <sw-cms-product-box-preview/> <sw-cms-product-box-preview/> </div> <sw-icon name="regular-chevron-right" size="20" /> </div> {% endblock %}';Shopware.Component.register("sw-cms-preview-tweakwise-cross-selling",{template:v});Shopware.Service("cmsService").registerCmsBlock({name:"tweakwise-cross-selling",category:"tweakwise",label:"Cross selling",component:"sw-cms-block-tweakwise-cross-selling",previewComponent:"sw-cms-preview-tweakwise-cross-selling",defaultConfig:{marginBottom:"0",marginTop:"0",marginLeft:"0",marginRight:"0",sizingMode:"boxed"},slots:{products:"tweakwise-cross-selling"}});const y='{% block sw_cms_block_tweakwise_featured_products %} <div class="sw-cms-block-tweakwise-featured-products"> <slot name="products">{% block sw_cms_block_tweakwise_featured_products_products %}{% endblock %}</slot> </div> {% endblock %}';Shopware.Component.register("sw-cms-block-tweakwise-featured-products",{template:y});const _='{% block sw_cms_block_tweakwise_featured_products_preview %} <div class="sw-cms-preview-tweakwise-featured-products"> <sw-icon name="regular-chevron-left" size="20" /> <div class="sw-cms-preview-tweakwise-featured-products__product-box"> <sw-cms-product-box-preview/> <sw-cms-product-box-preview/> </div> <sw-icon name="regular-chevron-right" size="20" /> </div> {% endblock %}';Shopware.Component.register("sw-cms-preview-tweakwise-featured-products",{template:_});Shopware.Service("cmsService").registerCmsBlock({name:"tweakwise-featured-products",category:"tweakwise",label:"Featured products",component:"sw-cms-block-tweakwise-featured-products",previewComponent:"sw-cms-preview-tweakwise-featured-products",defaultConfig:{marginBottom:"20px",marginTop:"20px",marginLeft:"20px",marginRight:"20px",sizingMode:"boxed"},slots:{products:"tweakwise-featured-products"}});const C="";Shopware.Component.override("sw-cms-el-config-product-listing",{template:C,computed:{boxLayoutOptions(){return[{id:1,value:"standard",label:this.$tc("sw-cms.elements.productBox.config.label.layoutTypeStandard")},{id:2,value:"image",label:this.$tc("sw-cms.elements.productBox.config.label.layoutTypeImage")},{id:3,value:"minimal",label:this.$tc("sw-cms.elements.productBox.config.label.layoutTypeMinimal")},{id:50,value:"tweakwise",label:this.$tc("sw-cms.elements.productBox.config.label.layoutTypeTweakwise")}]}}});const S=`{% block sw_cms_element_tweakwise_cross_selling %} <div class="sw-cms-el-tweakwise-cross-selling"> <h2 class="sw-cms-el-tweakwise-cross-selling__title"> {{ placeholder(tweakwiseCrossSelling, 'name', tweakwiseCrossSelling.name) }} </h2> <div class="sw-cms-el-tweakwise-cross-selling__content"> <div class="sw-cms-el-tweakwise-cross-selling__navigation"> <sw-icon class="sw-cms-el-tweakwise-cross-selling__navigation-button" name="regular-chevron-left" size="24" /> </div> <div ref="productHolder" class="sw-cms-el-cross-selling__product-holder" :style="sliderBoxMinWidth" > <sw-cms-el-product-box v-for="index in 4" :key="index" :element="demoProductElement" /> </div> <div class="sw-cms-el-tweakwise-cross-selling__navigation"> <sw-icon class="sw-cms-el-tweakwise-cross-selling__navigation-button" name="regular-chevron-right" size="24" /> </div> </div> </div> {% endblock %}`,{Mixin:d}=Shopware;Shopware.Component.register("sw-cms-el-tweakwise-cross-selling",{template:S,mixins:[d.getByName("cms-element"),d.getByName("placeholder")],computed:{demoProductElement(){return{config:{boxLayout:{source:"static",value:"standard"},displayMode:{source:"static",value:"standard"},elMinWidth:{source:"static",value:"200px"}}}},sliderBoxMinWidth(){return"repeat(auto-fit, minmax(200px, 1fr))"},tweakwiseCrossSelling(){return{name:"Tweakwise Cross Selling"}}}});const x='{% block sw_cms_element_tweakwise_featured_products_preview %} <div class="sw-cms-el-preview-tweakwise-cross-selling"> <sw-icon name="regular-chevron-left" size="10" /> <sw-cms-product-box-preview :has-text="false"/> <sw-icon name="regular-chevron-right" size="10" /> </div> {% endblock %}';Shopware.Component.register("sw-cms-el-preview-tweakwise-cross-selling",{template:x});const I=`{% block sw_cms_element_dailymotion_config %} <sw-text-field v-model="groupKey" class="swag-groupkey-field" :label="$tc('sw-cms.elements.tweakwiseCrossSelling.config.groupKey.label')" :help-text="$tc('sw-cms.elements.tweakwiseCrossSelling.config.groupKey.helpText')" required :placeholder="$tc('sw-cms.elements.tweakwiseCrossSelling.config.groupKey.placeHolder')" @input="onElementUpdate" @change="onElementUpdate" @update:value="onElementUpdate" > </sw-text-field> {% endblock %}`;Shopware.Component.register("sw-cms-el-config-tweakwise-cross-selling",{template:I,mixins:["cms-element"],computed:{groupKey:{get(){return this.element.config.groupKey.value},set(e){this.element.config.groupKey.value=e}}},created(){this.createdComponent()},methods:{createdComponent(){this.initElementConfig("tweakwise-cross-selling")},onElementUpdate(e){this.$emit("element-update",this.element)}}});Shopware.Service("cmsService").registerCmsElement({name:"tweakwise-cross-selling",label:"sw-cms.elements.tweakwiseFeaturedProducts.label",component:"sw-cms-el-tweakwise-cross-selling",configComponent:"sw-cms-el-config-tweakwise-cross-selling",previewComponent:"sw-cms-el-preview-tweakwise-cross-selling",defaultConfig:{groupKey:{required:!0,source:"static",value:""}}});const $='{% block sw_cms_element_tweakwise_featured_products %} <div class="sw-cms-el-tweakwise-featured-products"> <sw-icon name="regular-chevron-left" size="10" /> <sw-cms-product-box-preview/> <sw-cms-product-box-preview/> <sw-cms-product-box-preview/> <sw-cms-product-box-preview/> <sw-icon name="regular-chevron-right" size="10" /> </div> {% endblock %}';Shopware.Component.register("sw-cms-el-tweakwise-featured-products",{template:$});const T='{% block sw_cms_element_tweakwise_featured_products_preview %} <div class="sw-cms-el-preview-tweakwise-featured-products"> <sw-icon name="regular-chevron-left" size="10" /> <sw-cms-product-box-preview :has-text="false"/> <sw-icon name="regular-chevron-right" size="10" /> </div> {% endblock %}';Shopware.Component.register("sw-cms-el-preview-tweakwise-featured-products",{template:T});const L=`{% block sw_cms_element_dailymotion_config %} <sw-text-field v-model="groupId" class="swag-groupid-field" :label="$tc('sw-cms.elements.tweakwiseFeaturedProducts.config.groupId.label')" :help-text="$tc('sw-cms.elements.tweakwiseFeaturedProducts.config.groupId.helpText')" required :placeholder="$tc('sw-cms.elements.tweakwiseFeaturedProducts.config.groupId.placeHolder')" @input="onElementUpdate" @change="onElementUpdate" @update:value="onElementUpdate" > </sw-text-field> {% endblock %}`;Shopware.Component.register("sw-cms-el-config-tweakwise-featured-products",{template:L,mixins:["cms-element"],computed:{groupId:{get(){return this.element.config.groupId.value},set(e){this.element.config.groupId.value=e}}},created(){this.createdComponent()},methods:{createdComponent(){this.initElementConfig("tweakwise-featured-products")},onElementUpdate(e){this.$emit("element-update",this.element)}}});Shopware.Service("cmsService").registerCmsElement({name:"tweakwise-featured-products",label:"sw-cms.elements.tweakwiseFeaturedProducts.label",component:"sw-cms-el-tweakwise-featured-products",configComponent:"sw-cms-el-config-tweakwise-featured-products",previewComponent:"sw-cms-el-preview-tweakwise-featured-products",defaultConfig:{groupId:{required:!0,source:"static",value:""}}});const M=`{% block sw_product_detail_content_tabs_reviews %} {% parent %} <sw-tabs-item v-if="hasEnabledFrontends" :route="{ name: 'sw.product.detail.tweakwise', params: { id: $route.params.id } }" :title="$tc('sw-product.detail.tab.title') "> {{ $tc('sw-product.detail.tab.title') }} </sw-tabs-item> {% endblock %}`,{Criteria:w}=Shopware.Data;Shopware.Component.override("sw-product-detail",{template:M,inject:["repositoryFactory","feature","acl"],data(){return{frontendCount:0,isLoadingFrontends:!1}},computed:{twFeedRepository(){return this.repositoryFactory.create("s_plugin_rhae_tweakwise_frontend")},hasEnabledFrontends(){return this.frontendCount>0}},methods:{async createdComponent(){this.$super("createdComponent"),this.isLoadingFrontends=!0;const e=new w(1,1);e.addFilter(w.equals("backendSyncEnabled",!0));const t=await this.twFeedRepository.search(e,Shopware.Context.api);this.frontendCount=t.total,this.isLoadingFrontends=!1}}});const D=`<div :isLoading="isLoading" class="tweakwise-sync"> <sw-container v-if="product && product.childCount"> <mt-banner variant="attention" class="sw-bulk-edit-save-modal__warning" > {{ $tc('sw-product.detail.tab.variants') }} </mt-banner> </sw-container> <template v-for="frontend in frontends"> <sw-card :title="frontend.name" v-if="frontend.accessToken && frontend.backendSyncEnabled"> <sw-container columns="1fr 1fr" gap="10px 30px" > <div> {{ $tc('sw-product.detail.tab.productId') }} </div> <div> {{ productId[frontend.id] }} </div> <div> {{ $tc('sw-product.detail.tab.available') }} </div> <div> <span v-if="availability[frontend.id]">{{ $tc('sw-product.detail.tab.availableYes') }}</span> <span v-else>{{ $tc('sw-product.detail.tab.availableNo') }}</span> </div> <div v-if="availability[frontend.id]"> {{ $tc('sw-product.detail.tab.lastModified') }} </div> <div v-if="availability[frontend.id]"> <sw-time-ago :date="new Date(tweakwiseData[frontend.id].LastModified)" :date-time-format="{ month: '2-digit', day: '2-digit' }" /> </div> <div> <mt-button :isLoading="isLoading" size="small" variant="primary" @click="onSync(frontend.id, productId[frontend.id])" > {{ $tc('sw-product.detail.tab.sync') }} </mt-button> </div> </sw-container> </sw-card> <sw-card :title="frontend.name" v-if="!frontend.accessToken"> <mt-banner variant="attention" class="sw-bulk-edit-save-modal__warning" > {{ $tc('sw-product.detail.tab.noAccessToken') }} </mt-banner> </sw-card> </template> </div>`,{Component:A,Mixin:z,Context:ce}=Shopware,{EntityCollection:de,Criteria:N}=Shopware.Data;A.register("sw-product-detail-tweakwise",{template:D,namespaced:!0,inject:["repositoryFactory","feature","acl"],mixins:[z.getByName("notification")],data(){return{frontends:null,availability:[],tweakwiseData:[],productId:[],product:null,backendSyncOptions:[],isLoading:!1}},created(){this.createdComponent()},computed:{twFeedRepository(){return this.repositoryFactory.create("s_plugin_rhae_tweakwise_frontend")}},methods:{createdComponent(){this.isLoading=!0,this.getData(),this.isLoading=!1},async getData(){const e=new N(this.page,this.limit,this.term),t=Shopware.Application.getContainer("init").httpClient,i=await this.twFeedRepository.search(e,Shopware.Context.api);this.frontends=i;const n={headers:{Authorization:`Bearer ${Shopware.Service("loginService").getToken()}`}},l=i.map(s=>{const f=`/_action/rhae-tweakwise/check-data/${s.id}/${this.$route.params.id}`;return t.get(f,n)});return(await Promise.all(l)).forEach(s=>{s.data.error?this.availability[s.data.frontendId]=!1:(this.availability[s.data.frontendId]=!0,this.tweakwiseData[s.data.frontendId]=s.data.productData),this.productId[s.data.frontendId]=s.data.productId,this.product=s.data.product}),!0},async onSync(e,t){this.isLoading=!0;const a={headers:{Authorization:`Bearer ${Shopware.Service("loginService").getToken()}`}},n=Shopware.Application.getContainer("init").httpClient,l=`/_action/rhae-tweakwise/sync-data/${e}/${this.$route.params.id}`,o=await n.get(l,a);o.status===200&&o.data.updated?(this.createNotificationSuccess({title:this.$tc("sw-product.detail.tab.syncSuccessTitle"),message:this.$tc("sw-product.detail.tab.syncSuccessMessage")}),await this.getData()):(this.createNotificationWarning({title:this.$tc("sw-product.detail.tab.syncFailedTitle"),message:this.$tc("sw-product.detail.tab.syncFailedMessage")}),console.warn(o)),this.isLoading=!1}}});const j=`{% block sw_prduct_cross_selling_form_product_stream_field %} <div v-if="!useTweakwise"> {% parent %} </div> <div v-if="useTweakwise"> <sw-text-field v-model:value="crossSelling.extensions.tweakwise.groupKey" :label="$tc('sw-product.crossselling.tweakwiseGroupKey')" required validation="required" placeholder="Default is sw-cross-sell" :disabled="!allowEdit" /> </div> {% endblock %} {% block sw_prduct_cross_selling_form_sort_field %} <div v-if="!useTweakwise"> {% parent %} </div> {% endblock %} {% block sw_prduct_cross_selling_form_limit_field %} <div v-if="!useTweakwise"> {% parent %} </div> {% endblock %} {% block sw_prduct_cross_selling_form_preview_link %} <div v-if="!useTweakwise"> {% parent %} </div> {% endblock %}`,{Criteria:we}=Shopware.Data,{Component:P,Context:pe}=Shopware,{mapPropertyErrors:me,mapGetters:ue,mapState:he}=P.getComponentHelper();Shopware.Component.override("sw-product-cross-selling-form",{template:j,created(){this.crossSelling.extensions.tweakwise||(this.crossSelling.extensions.tweakwise=this.repositoryFactory.create("product_cross_selling_tweakwise").create(Shopware.Context.api))},computed:{crossSellingTypes(){return[{label:this.$tc("sw-product.crossselling.tweakwiseType"),value:"tweakwiseRecommendation"},{label:this.$tc("sw-product.crossselling.productStreamType"),value:"productStream"},{label:this.$tc("sw-product.crossselling.productListType"),value:"productList"}]}},data(){return{showDeleteModal:!1,showModalPreview:!1,productStream:null,productStreamFilter:[],productStreamFilterTree:null,optionSearchTerm:"",useManualAssignment:!1,useTweakwise:!1,sortBy:"name",sortDirection:"ASC",assignmentKey:0}},watch:{"crossSelling.productStreamId"(){!this.useManualAssignment&&!this.useTweakwise&&this.loadStreamPreview()}},methods:{createdComponent(){this.useManualAssignment=this.crossSelling.type==="productList",this.useTweakwise=this.crossSelling.type==="tweakwiseRecommendation"},onTypeChanged(e){this.useManualAssignment=e==="productList",this.useTweakwise=e==="tweakwiseRecommendation"}}});const B=`{% block sw_product_variants_delivery_listing_config_single_main_variant_explanation %} {% parent %} <sw-alert variant="warning" :title="$tc('sw-product.listing.warningTitle')" :closable="false" style="margin-top: 1rem;" v-if="!isDisabledListingMode('single')" > {{ $tc('sw-product.listing.warning') }} </sw-alert> {% endblock %} {% block sw_product_variants_delivery_listing_config_expanded_group_list %} {% parent %} <sw-alert variant="warning" :title="$tc('sw-product.listing.warningTitle')" :closable="false" style="margin-top: 1rem;" v-if="!isDisabledListingMode('expanded')" > {{ $tc('sw-product.listing.warning') }} </sw-alert> {% endblock %}`;Shopware.Component.override("sw-product-variants-delivery-listing",{template:B});Shopware.Module.register("sw-new-tab-tweakwise",{routeMiddleware(e,t){const i="sw.product.detail.tweakwise";t.name==="sw.product.detail"&&t.children.every(a=>a.name!==i)&&t.children.push({name:i,path:"/sw/product/detail/:id/tweakwise",component:"sw-product-detail-tweakwise",meta:{parentPath:"sw.product.index"}}),e(t)}});const O=`<sw-page class="rhae-tweakwise-feed-list"> <template #smart-bar-header> <h2> {{ $tc('rhae-tweakwise-feed.main.menuLabel') }} </h2> </template> <template #smart-bar-actions> <sw-button variant="primary" size="default" :routerLink="{ name: 'rhae.tweakwise.feed.create' }" > {{ $tc('rhae-tweakwise-feed.list.addButtonText') }} </sw-button> </template> <template #content> <sw-entity-listing v-if="items" :items="items" :repository="repository" :showSelection="true" :columns="columns" detailRoute="rhae.tweakwise.feed.detail" @select-item="updateSelection" @update-records="updateTotal" > <template #column-type="{ item }"> {{ $tc('rhae-tweakwise-feed.detail.label.typeOptions.' + item.type) }} </template> <template #column-domains="{ item }"> <template v-for="(domain, index) in item.salesChannelDomains"> {{ domain.url }} <span v-if="index < (item.salesChannelDomains.length - 1)"> <br/> </span> </template> </template> <template #column-lastGeneratedAt="{ item }"> <sw-time-ago :date="item.lastGeneratedAt"/> </template> </sw-entity-listing> </template> </sw-page>`,{Component:G,Mixin:p,Context:F}=Shopware,{Criteria:E}=Shopware.Data;G.register("rhae-tweakwise-feed-list",{template:O,inject:["repositoryFactory","numberRangeService","context"],mixins:[p.getByName("notification"),p.getByName("listing")],data(){return{items:null,sortBy:"name"}},metaInfo(){return{title:this.$createTitle()}},computed:{repository(){return this.repositoryFactory.create("s_plugin_rhae_tweakwise_feed")},searchContext(){return{...F.api,inheritance:!0}},columns(){return[{property:"name",dataIndex:"name",label:this.$t("rhae-tweakwise-feed.list.columns.name"),routerLink:"rhae.tweakwise.feed.detail",inlineEdit:"string",allowResize:!0,primary:!0},{property:"type",dataIndex:"type",label:this.$t("rhae-tweakwise-feed.list.columns.type"),inlineEdit:"string"},{property:"domains",dataIndex:"domains",label:this.$t("rhae-tweakwise-feed.list.columns.domains")},{property:"lastGeneratedAt",dataIndex:"lastGeneratedAt",label:this.$t("rhae-tweakwise-feed.list.columns.lastGeneratedAt")}]}},methods:{async getList(){const e=new E(this.page,this.limit,this.term);e.addAssociation("salesChannelDomains"),this.isLoading=!0;try{const t=await this.repository.search(e,Shopware.Context.api);this.total=t.total,this.isLoading=!1,this.items=t,this.selection={}}catch{this.isLoading=!1}},changeLanguage(){this.getList()},updateSelection(){},updateTotal({total:e}){this.total=e},onDuplicate(e){this.repository.clone(e.id,Shopware.Context.api,{name:`${e.name} ${this.$tc("sw-product.general.copy")}`,locked:!1}).then(t=>{this.$router.push({name:"rhae.tweakwise.feed.detail",params:{id:t.id}})})}},created(){}});const g=`{% block sw_tweakwise_feed_detail %} <sw-page class="rhae-tweakwise-feed-detail"> <template #smart-bar-actions> {% block sw_tweakwise_feed_detail_actions %} {% block sw_tweakwise_feed_detail_actions_refresh %} <mt-button @click="getItem" square size="default" > <mt-icon name="regular-undo" size="18" /> </mt-button> {% endblock %} {% block sw_tweakwise_feed_detail_actions_cancel %} <mt-button @click="$router.push({ name: 'rhae.tweakwise.feed.list' })" size="default"> {{ $t('rhae-tweakwise-feed.detail.cancelButtonText') }} </mt-button> {% endblock %} {% block sw_tweakwise_feed_detail_actions_save %} <sw-button-process :isLoading="isLoading" :processSuccess="processSuccess.general" variant="primary" @process-finish="saveFinish" @click="onClickSave" > {{ $t('rhae-tweakwise-feed.detail.saveButtonText') }} </sw-button-process> {% endblock %} {% endblock %} </template> <template #content> {% block sw_tweakwise_feed_detail_content %} <sw-card-view> {% block sw_tweakwise_feed_detail_content_main %} <sw-card v-if="item" :isLoading="isLoading" :title="$tc('rhae-tweakwise-feed.detail.section.main')" > <sw-card-section v-if="item.salesChannelDomains[0]" divider="bottom" > <sw-container columns="1fr" gap="30px" style="margin-bottom: 1rem;" > {% block sw_tweakwise_feed_detail_content_main_url %} <div> <p class="rhae-tweakwise-feed__card-toolbar-heading" > {{ $t('rhae-tweakwise-feed.detail.label.feedUrl') }} </p> <p> {{ item.salesChannelDomains[0].url }} /tweakwise/feed- {{item.id}} .xml <sw-button size="small" square style="margin-left: 0.5rem;" @click="copyLinkToClipboard" @keydown.enter="copyLinkToClipboard" > <sw-icon size="16" name="regular-copy" /> </sw-button> </p> </div> {% endblock %} </sw-container> <sw-container class="rhae-tweakwise-feed__card-toolbar" columns="repeat(3, 1fr)" > {% block sw_tweakwise_feed_detail_content_main_last_generated %} <div> <p class="rhae-tweakwise-feed__card-toolbar-heading" > {{ $t('rhae-tweakwise-feed.detail.label.lastGeneratedAt') }} </p> <p v-if="item.lastGeneratedAt"><sw-time-ago :date="item.lastGeneratedAt" :key="item.lastGeneratedAt" /></p> <p v-else>-</p> </div> {% endblock %} {% block sw_tweakwise_feed_detail_content_main_next_generation %} <div> <p class="rhae-tweakwise-feed__card-toolbar-heading" > {{ $t('rhae-tweakwise-feed.detail.label.nextGenerationAt') }} </p> <p v-if="item.nextGenerationAt"> {{ dateFilter(item.nextGenerationAt, { hour: '2-digit', minute: '2-digit' }) }} </p> <p v-else> {{ $t('rhae-tweakwise-feed.detail.label.withinOneMinute') }} </p> <sw-button size="small" style="margin-top: 1rem;" @click="generateFeedNow" :isLoading="isLoading" > {{ $t('rhae-tweakwise-feed.detail.label.generateNow') }} </sw-button> </div> {% endblock %} {% block sw_tweakwise_feed_detail_content_main_status %} <div> <p class="rhae-tweakwise-feed__card-toolbar-heading" > {{ $t('rhae-tweakwise-feed.detail.label.status') }} </p> <p> {{ $tc(\`rhae-tweakwise-feed.detail.label.statusOption.\${item.status}\`) }} </p> </div> {% endblock %} </sw-container> </sw-card-section> <sw-card-section> {% block sw_tweakwise_feed_detail_content_main_type %} <mt-select v-model="item.type" :label="$t('rhae-tweakwise-feed.detail.label.type')" :options="feedTypes" /> {% endblock %} {% block sw_tweakwise_feed_detail_content_main_name %} <sw-text-field :label="$t('rhae-tweakwise-feed.detail.label.name')" v-model:value="item.name" required validation="required" ></sw-text-field> {% endblock %} {% block sw_tweakwise_feed_detail_content_main_domains %} <sw-entity-multi-select :label="$t('rhae-tweakwise-feed.detail.label.salesChannelDomains')" labelProperty="url" value-property="id" v-model:entityCollection="item.salesChannelDomains" /> {% endblock %} {% block sw_tweakwise_feed_detail_content_main_interval %} <sw-text-field :label="$t('rhae-tweakwise-feed.detail.label.interval')" v-model:value="item.interval" required validation="required" ></sw-text-field> {% endblock %} {% block sw_tweakwise_feed_detail_content_main_import_task_url %} <sw-text-field :label="$t('rhae-tweakwise-feed.detail.label.importTaskUrl')" v-model:value="item.importTaskUrl" ></sw-text-field> {% endblock %} </sw-card-section> </sw-card> {% endblock %} {% block sw_tweakwise_feed_detail_content_settings_full %} <sw-card v-if="item && item.type === 'full'" :isLoading="isLoading" :title="$tc('rhae-tweakwise-feed.detail.section.data')" > <sw-card-section> {% block sw_tweakwise_feed_detail_content_settings_full_include_hidden_categories %} <mt-switch v-model="item.includeHiddenCategories" :label="$tc('rhae-tweakwise-feed.detail.label.includeHiddenCategories')" /> {% endblock %} {% block sw_tweakwise_feed_detail_content_settings_full_grouped_products %} <mt-switch v-model="item.groupedProducts" :label="$tc('rhae-tweakwise-feed.detail.label.groupedProducts')" /> {% endblock %} {% block sw_tweakwise_feed_detail_content_settings_full_include_custom_fields %} <mt-switch v-model="item.includeCustomFields" :label="$tc('rhae-tweakwise-feed.detail.label.includeCustomFields')" /> {% endblock %} {% block sw_tweakwise_feed_detail_content_settings_full_respect_hide_closeoutproducts_out_of_stock %} <mt-switch v-model="item.respectHideCloseoutProductsWhenOutOfStock" :label="$tc('rhae-tweakwise-feed.detail.label.respectHideCloseoutProductsWhenOutOfStock')" /> {% endblock %} </sw-card-section> </sw-card> {% endblock %} {% block sw_tweakwise_feed_detail_advanced %} <sw-card class="card-advanced" v-if="item && item.type === 'full'" :isLoading="isLoading" :title="$tc('rhae-tweakwise-feed.detail.section.advanced')"> <sw-card-section> {% block sw_tweakwise_feed_detail_advanced_limit %} <p style="margin-bottom: 1rem;">{{ $t('rhae-tweakwise-feed.detail.info.limit') }}</p> <mt-select v-model="item.limit" :label="$t('rhae-tweakwise-feed.detail.label.limit')" :options="batchSizes" /> {% endblock %} </sw-card-section> </sw-card> {% endblock %} </sw-card-view> {% endblock %} </template> </sw-page> {% endblock %}`,{Component:Z}=Shopware;Z.extend("rhae-tweakwise-feed-create","rhae-tweakwise-feed-detail",{template:g,methods:{getItem(){this.item=this.repository.create(Shopware.Context.api),this.item.includeHiddenCategories=!1,this.item.limit=10,this.isLoading=!1},onClickSave(){this.isLoading=!0,this.repository.save(this.item,Shopware.Context.api).then(()=>{this.isLoading=!1,this.$router.push({name:"rhae.tweakwise.feed.detail",params:{id:this.item.id}})}).catch(e=>{this.isLoading=!1,this.createNotificationError({title:this.$tc("rhae-tweakwise.notification.errorTitle"),message:e})})}}});const{Component:R,Mixin:W,Context:r,Utils:U}=Shopware,{EntityCollection:Y,Criteria:m}=Shopware.Data,{mapPropertyErrors:ge}=Shopware.Component.getComponentHelper(),{dom:H,format:ke}=U;R.register("rhae-tweakwise-feed-detail",{template:g,inject:["repositoryFactory","context"],mixins:[W.getByName("notification")],metaInfo(){return{title:this.$createTitle()}},data(){return{item:null,salesChannelDomains:null,isLoading:!1,salesChannelDomainIds:[],processes:{generateFeed:!1},processSuccess:{general:!1,generateFeed:!1}}},computed:{feedTypes(){return[{id:1,value:"full",label:this.$tc("rhae-tweakwise-feed.detail.label.typeOptions.full")}]},batchSizes(){return[{id:1,value:"1",label:"1"},{id:10,value:"10",label:"10"},{id:25,value:"25",label:"25"},{id:50,value:"50",label:"50"},{id:100,value:"100",label:"100"},{id:250,value:"250",label:"250"}]},repository(){return this.repositoryFactory.create("s_plugin_rhae_tweakwise_feed")},salesChannelDomainRepository(){return this.repositoryFactory.create("sales_channel_domain")},salesChannelDomainIds:{get(){return this.salesChannelDomainIds||[]},set(e){this.salesChannelDomainIds={...this.salesChannelDomainIds,salesChannelDomainIds:e}}},dateFilter(){return Shopware.Filter.getByName("date")},defaultCriteria(){return new m}},created(){this.getItem(),this.getSalesChannelDomains()},methods:{getSalesChannelDomains(){this.salesChannelDomains=new Y(this.salesChannelDomainRepository.route,this.salesChannelDomainRepository.entityName,r.api)},getFeedUrl(){return this.item.salesChannelDomains[0].url+"/tweakwise/feed-"+this.item.id+".xml"},resetButtons(){this.processSuccess={general:!1,generateFeed:!1}},generateFeedNow(){this.isLoading=!0,this.item.nextGenerationAt=null,this.repository.save(this.item,r.api).then(()=>{this.getItem(),this.isLoading=!1,this.processSuccess=!0}).catch(e=>{this.isLoading=!1,this.createNotificationError({title:"Unknown error",message:e})})},getItem(){var e=new m;e.addAssociation("salesChannelDomains"),this.repository.get(this.$route.params.id,r.api,e).then(t=>{this.item=t})},onChangeValue(e,t,i=!0){this.item[t]=e,this.$emit("change-value",t,e)},onChangeToggle(e,t){this.onChangeValue(e,t,!1)},convert(e,t){console.log(e)},onChangeToggleRevert(e,t){console.log(e),this.onChangeValue(e,t,!1)},onClickSave(){this.isLoading=!0,this.repository.save(this.item,r.api).then(()=>{this.getItem(),this.isLoading=!1,this.processSuccess=!0}).catch(e=>{this.isLoading=!1,this.createNotificationError({title:this.$tc("rhae-tweakwise-feed.notification.errorTitle"),message:e})})},setSalesChannelDomains(e){this.salesChannelDomains=e,this.item.salesChannelDomains=e},saveFinish(){this.processSuccess=!1},async copyLinkToClipboard(){if(this.item)try{await H.copyStringToClipboard(this.getFeedUrl()),this.createNotificationSuccess({message:this.$tc("sw-media.general.notification.urlCopied.message")})}catch{this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("global.sw-field.notification.notificationCopyFailureMessage")})}}}});const X='{% block rhae_tweakwise_settings_icon %} <div class="rhae-tweakwise-settings-icon"> <img height="30" width="30" src="data:image/svg+xml;base64,PHN2ZyB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiIHhtbG5zOmlua3NjYXBlPSJodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy9uYW1lc3BhY2VzL2lua3NjYXBlIiBpZD0iVHdlYWt3aXNlX3dpdCIgdmlld0JveD0iMCAwIDM5NC4yNzIgNDE5Ljc1MzYiIHZlcnNpb249IjEuMSIgc29kaXBvZGk6ZG9jbmFtZT0idHdlYWt3aXNlLWxldHRlci13aXQuc3ZnIiB3aWR0aD0iMzk0LjI3MiIgaGVpZ2h0PSI0MTkuNzUzNiIgaW5rc2NhcGU6dmVyc2lvbj0iMS4wLjIgKGU4NmM4NzA4LCAyMDIxLTAxLTE1KSI+CiAgPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTg5NCIgZmlsbD0iIzAwMDAwMCI+CiAgICA8cmRmOlJERiBmaWxsPSIjMDAwMDAwIj4KICAgICAgPGNjOldvcmsgcmRmOmFib3V0PSIiIGZpbGw9IiMwMDAwMDAiPgogICAgICAgIDxkYzpmb3JtYXQgZmlsbD0iIzAwMDAwMCI+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIGZpbGw9IiMwMDAwMDAiLz4KICAgICAgICA8ZGM6dGl0bGUgZmlsbD0iIzAwMDAwMCIvPgogICAgICA8L2NjOldvcms+CiAgICA8L3JkZjpSREY+CiAgPC9tZXRhZGF0YT4KICA8ZGVmcyBpZD0iZGVmczg5MiIgZmlsbD0iIzAwMDAwMCIvPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcgcGFnZWNvbG9yPSIjMmQyZTMyIiBib3JkZXJjb2xvcj0iIzY2NjY2NiIgYm9yZGVyb3BhY2l0eT0iMSIgb2JqZWN0dG9sZXJhbmNlPSIxMCIgZ3JpZHRvbGVyYW5jZT0iMTAiIGd1aWRldG9sZXJhbmNlPSIxMCIgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAiIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTc5MiIgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTAwNyIgaWQ9Im5hbWVkdmlldzg5MCIgc2hvd2dyaWQ9ImZhbHNlIiBmaXQtbWFyZ2luLXRvcD0iMCIgZml0LW1hcmdpbi1sZWZ0PSIwIiBmaXQtbWFyZ2luLXJpZ2h0PSIwIiBmaXQtbWFyZ2luLWJvdHRvbT0iMCIgaW5rc2NhcGU6em9vbT0iMC42NjcyODY3NiIgaW5rc2NhcGU6Y3g9IjcyMS41NTk1IiBpbmtzY2FwZTpjeT0iMjM4LjUyNzM0IiBpbmtzY2FwZTp3aW5kb3cteD0iMCIgaW5rc2NhcGU6d2luZG93LXk9IjI1IiBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIwIiBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJUd2Vha3dpc2Vfd2l0IiBpbmtzY2FwZTpkb2N1bWVudC1yb3RhdGlvbj0iMCIgZmlsbD0iIzAwMDAwMCIvPgogIDxwYXRoIGQ9Ik0gMjQxLjgxNTA5LDMzNi44MTMyNiBWIDkxLjQyNTQ2NCBoIDUwLjk4ODUgYyA1LjI0MjQsMCA2LjY3NywtMS42NTg4IDcuNjMwOCwzLjExODkgbCA3LjYzMDksMzkuMzUwMjk2IGggNTIuNjYzNSBWIDQwLjQ2MjM2NCBIIDQ2LjQ1Njc4OCB2IDkzLjQzMjE5NiBoIDU4LjkxODMwMiBsIDcuNjMwOSwtMzkuMzUwMjk2IGMgMC45NDUzLC00Ljc3NzggMi4zODA4LC0zLjExODkgNy42MzA4LC0zLjExODkgaCA0NC43MzM3IFYgMzM2LjgxMzI2IGMgMCw3LjE1NzggMS45NDA4LDkuMDY1NSAtNC43MzYyLDkuNTM4NiBsIC00Ni4yMjY4LDMuMzQzMiB2IDMwLjUyMDkgaCAxODYuODY0NSB2IC0zMC41MjA5IGwgLTUyLjE0MTIsLTMuODE2MyBjIC03LjE1NzgsLTAuNDgwOCAtNy4zMTU3LC0yLjM4IC03LjMxNTcsLTkuMDY1NSB6IiBmaWxsPSIjMmQyZTMyIiBpZD0icGF0aDgzMyIgc3R5bGU9ImZpbGw6IzJkMmUzMiIvPgo8L3N2Zz4=" alt="Tweakwise logo" /> </div> {% endblock %}';Shopware.Component.register("rhae-tweakwise-settings-icon",{template:X});const J={"rhae-tweakwise-feed":{main:{menuLabel:"Tweakwise feed",menuDescription:"Configureer je Tweakwise feed"},list:{addButtonText:"Maak nieuwe feed",refreshButtonText:"Vernieuwen",columns:{name:"Feed naam",type:"Soort feed",domains:"Domeinnamen",lastGeneratedAt:"Laatst gegenereerd op"}},detail:{cancelButtonText:"Annuleren",saveButtonText:"Opslaan",section:{main:"Algemeen",data:"Data",advanced:"Geavanceerd"},info:{limit:"Producten worden vanuit Shopware opgehaald in batches. Met deze instelling bepaal je hoeveel producten er in 1 batch zitten. Hoe hoger het aantal, hoe meer geheugen het nodig heeft bij het genereren van de feed. Hoe lager het aantal, hoe meer tijd het zal kosten. De beste instelling is afhankelijk van de data. Probeer een zo hoog mogelijk aantal zonder dat dit problemen oplevert voor de server."},label:{name:"Naam",salesChannelDomains:"Domeinen",feedUrl:"Feed URL",lastGeneratedAt:"Laatst gegenereerd op",includeHiddenCategories:"Exporteer ook verborgen categorieÃ«n",includeHiddenCategoriesTrue:"Ja",includeHiddenCategoriesFalse:"Nee",interval:"Herhaling (cron notatie of interval in minuten)",importTaskUrl:"API URL van Import taak in Tweakwise",intervalDescription:"Let op dat de interval moet worden ingesteld in overleg met Tweakwise. Het heeft bijvoorbeeld geen nut om de feed iedere 30 minuten te updaten terwijl Tweakwise de feed maar een keer per dag ophaalt.",includeCustomFields:"Exporteer alle vrije velden van een product",respectHideCloseoutProductsWhenOutOfStock:"Respecteer Shopware instelling om uitverkoopproducten te verbergen als deze zijn uitverkocht",nextGenerationAt:"Wordt opnieuw gegenereerd op",limit:"Batch grootte",status:"Status",statusOption:{queued:"In de wachtrij",running:"Bezig",completed:"Afgerond",undefined:"-",null:"-"},intervalOptions:{30:"30 minuten",60:"1 uur",360:"6 uur",720:"12 uur",1440:"24 uur"},type:"Type feed",typeOptions:{full:"Volledige feed"},generateNow:"Opnieuw genereren",withinOneMinute:"Binnen een minuut",groupedProducts:"Exporteer alle varianten naar Tweakwise, zonder rekening te houden met de Shopware-instellingen"}}}},V={"rhae-tweakwise-feed":{main:{menuLabel:"Tweakwise feed",menuDescription:"Configure your Tweakwise feed"},list:{addButtonText:"Create new feed",refreshButtonText:"Refresh",columns:{name:"Feed name",type:"Type of feed",domains:"Domains",lastGeneratedAt:"Last generated at"}},detail:{cancelButtonText:"Cancel",saveButtonText:"Save",section:{main:"General",data:"Data",advanced:"Advanced"},info:{limit:"Products will be retrieved from Shopware in batches. How many products should be handled in one batch? The higher this number, the more memory it will consume during feed generation. The lower the number, the more time it will take to generate the feed. As the optimal performance depends on the data, you can try to get the highest number without stressing your server too much."},label:{name:"Name",salesChannelDomains:"Domains",feedUrl:"Feed URL",lastGeneratedAt:"Last generated at",includeHiddenCategories:"Include hidden categories",includeHiddenCategoriesTrue:"True",includeHiddenCategoriesFalse:"False",interval:"Recurring (cron notation or interval in minutes)",importTaskUrl:"API URL of Import Task in Tweakwise",intervalDescription:"Please be aware that the interval should be set as discussed with Tweakwise. It doesn't make sense to generate the feed every 30 minutes while Tweakwise gets the feed only once a day.",nextGenerationAt:"Will be regenerated on",status:"Status",exclude:"With the options below, you can decide what data should be available in the feed. By removing relations, you will lower the memory consumption. Please only use these toggles when you are familiar with the data structure of Shopware products.",excludeChildren:"I have no variant products. Remove the relation with child products",excludeReviews:"Don't add data of product reviews to the feed. The relation with reviews will not be made",excludeTags:"Tags should not be added to the feed. Remove the relation with tags",excludeOptions:"Options defining the variant should not be added to the feed. Remove the relation with options",excludeProperties:"Options that are not defining the variant should not be added to the feed. Remote the relation with properties",groupedProducts:"Export all variants to Tweakwise, ignoring the Shopware listing settings",includeCustomFields:"Include all custom fields in the feed",respectHideCloseoutProductsWhenOutOfStock:"Respect Shopware setting to hide products after clearance",limit:"Batch size",yesno:{0:"No",1:"Yes"},statusOption:{queued:"Queued",running:"Running",completed:"Completed",undefined:"-",null:"-"},intervalOptions:{30:"30 minutes",60:"1 hour",360:"6 hours",720:"12 hours",1440:"24 hours"},type:"Type of feed",typeOptions:{full:"Full feed"},generateNow:"Generate now",withinOneMinute:"Within one minute"},generate:{heading:"Generate feed",text:"The Tweakwise feed is automatically generated periodically. If you want to generate the feed now, you can do this by using the button on the right.",button:"Generate feed"}}}};Shopware.Module.register("rhae-tweakwise-feed",{type:"plugin",name:"Tweakwise Feed",title:"rhae-tweakwise-feed.main.menuLabel",description:"rhae-tweakwise-feed.main.menuDescription",color:"#028eca",snippets:{"nl-NL":J,"en-GB":V},routes:{list:{component:"rhae-tweakwise-feed-list",path:"list",meta:{parentPath:"sw.settings.index.plugins"}},detail:{component:"rhae-tweakwise-feed-detail",path:"detail/:id",meta:{parentPath:"rhae.tweakwise.feed.list"}},create:{component:"rhae-tweakwise-feed-create",path:"create",meta:{parentPath:"rhae.tweakwise.feed.list"}}},settingsItem:{name:"rhae-tweakwise-feed-list",to:"rhae.tweakwise.feed.list",label:"rhae-tweakwise-feed.main.menuLabel",group:"plugins",iconComponent:"rhae-tweakwise-settings-icon"}});const K=`<sw-page class="rhae-tweakwise-frontend-list"> <template #smart-bar-header> <h2> {{ $tc('rhae-tweakwise-frontend.main.menuLabel') }} </h2> </template> <template #smart-bar-actions> <sw-button variant="primary" size="default" :routerLink="{ name: 'rhae.tweakwise.frontend.create' }" > {{ $tc('rhae-tweakwise-frontend.list.addButtonText') }} </sw-button> </template> <template #content> <sw-entity-listing v-if="items" :items="items" :repository="repository" :showSelection="true" :columns="columns" detailRoute="rhae.tweakwise.frontend.detail" @select-item="updateSelection" @update-records="updateTotal" > <template #more-actions="{ item }"> <sw-context-menu-item @click="onDuplicate(item)"> {{ $tc('sw-product.list.buttonDuplicate') }} </sw-context-menu-item> </template> </sw-entity-listing> </template> </sw-page>`,{Component:Q,Mixin:u,Context:q}=Shopware,{Criteria:ee}=Shopware.Data;Q.register("rhae-tweakwise-frontend-list",{template:K,inject:["repositoryFactory","numberRangeService","context"],mixins:[u.getByName("notification"),u.getByName("listing")],data(){return{items:null,sortBy:"name"}},metaInfo(){return{title:this.$createTitle()}},computed:{repository(){return this.repositoryFactory.create("s_plugin_rhae_tweakwise_frontend")},searchContext(){return{...q.api,inheritance:!0}},columns(){return[{property:"name",dataIndex:"name",label:this.$t("rhae-tweakwise-frontend.list.columns.name"),routerLink:"rhae.tweakwise.frontend.detail",inlineEdit:"string",allowResize:!0,primary:!0}]}},methods:{async getList(){const e=new ee(this.page,this.limit,this.term);this.isLoading=!0;try{const t=await this.repository.search(e,Shopware.Context.api);this.total=t.total,this.isLoading=!1,this.items=t,this.selection={}}catch{this.isLoading=!1}},changeLanguage(){this.getList()},updateSelection(){},updateTotal({total:e}){this.total=e},onDuplicate(e){this.repository.clone(e.id,Shopware.Context.api,{name:`${e.name} ${this.$tc("sw-product.general.copy")}`,locked:!1}).then(t=>{this.$router.push({name:"rhae.tweakwise.frontend.detail",params:{id:t.id}})})}},created(){}});const k=`<sw-page class="rhae-tweakwise-frontend-detail"> <template #smart-bar-actions> <sw-button size="default" :routerLink="{ name: 'rhae.tweakwise.frontend.list' }"> {{ $t('rhae-tweakwise-frontend.detail.cancelButtonText') }} </sw-button> <sw-button-process :isLoading="isLoading" :processSuccess="processSuccess" variant="primary" @process-finish="saveFinish" @click="onClickSave" > {{ $t('rhae-tweakwise-frontend.detail.saveButtonText') }} </sw-button-process> </template> <template #content> <sw-card-view> <sw-card v-if="item" :isLoading="isLoading" :title="$tc('rhae-tweakwise-frontend.detail.section.main')" > <sw-card-section> <sw-entity-multi-select :label="$t('rhae-tweakwise-frontend.detail.label.salesChannelDomains')" labelProperty="url" value-property="id" v-model:entityCollection="item.salesChannelDomains" /> <sw-text-field :label="$t('rhae-tweakwise-frontend.detail.label.name')" v-model:value="item.name" required validation="required" ></sw-text-field> <sw-text-field :label="$t('rhae-tweakwise-frontend.detail.label.token')" v-model:value="item.token" :error="tokenError" @blur="checkPossibilities" ></sw-text-field> <sw-text-field :label="$t('rhae-tweakwise-frontend.detail.label.accessToken')" v-model:value="item.accessToken" ></sw-text-field> <mt-select v-if="validToken" v-model="item.integration" :label="$t('rhae-tweakwise-frontend.detail.label.integration')" :options="integrationTypes" /> <sw-checkbox-field v-model:value="item.eventTagEnabled" :label="$t('rhae-tweakwise-frontend.detail.label.eventTagEnabled')" @update:value="onChangeToggle($event, 'eventTagEnabled')" /> </sw-card-section> </sw-card> <sw-card v-if="validToken && (item.integration === 'javascript' || item.integration === 'pluginstudio')" :isLoading="isLoading" :title="$tc('rhae-tweakwise-frontend.detail.section.search')" > <sw-card-section> <mt-select v-model="item.wayOfSearch" :label="$t('rhae-tweakwise-frontend.detail.label.wayOfSearch')" :options="wayOfSearchTypes" /> <sw-container columns="2fr 2fr 2fr" gap="0px 30px" v-if="item.integration === 'javascript'" > <sw-number-field numberType="int" :label="$t('rhae-tweakwise-frontend.detail.label.productsDesktop')" v-model:value="item.productsDesktop" > </sw-number-field> <sw-number-field numberType="int" :label="$t('rhae-tweakwise-frontend.detail.label.productsTablet')" v-model:value="item.productsTablet" > </sw-number-field> <sw-number-field numberType="int" :label="$t('rhae-tweakwise-frontend.detail.label.productsMobile')" v-model:value="item.productsMobile" > </sw-number-field> </sw-container> <sw-select-field :label="$t('rhae-tweakwise-frontend.detail.label.paginationType')" v-model:value="item.paginationType" v-if="item.integration === 'javascript'" > <option v-for="value in ['default','button', 'infinite']" :value="value" > {{ $tc('rhae-tweakwise-frontend.detail.label.paginationTypeOptions.' + value) }} </option> </sw-select-field> </sw-card-section> </sw-card> <sw-card v-if="validToken && (item.integration === 'javascript' || item.integration === 'pluginstudio')" :isLoading="isLoading" :title="$tc('rhae-tweakwise-frontend.detail.section.merchandise')"> <sw-card-section> <sw-checkbox-field v-model:value="item.fullPathCid" :label="$t('rhae-tweakwise-frontend.detail.label.fullPathCid')" @update:value="onChangeToggle($event, 'fullPathCid')" /> </sw-card-section> </sw-card> <sw-card v-if="validToken && recommendationsAvailable && (item.integration === 'javascript' || item.integration === 'pluginstudio')" :isLoading="isLoading" :title="$tc('rhae-tweakwise-frontend.detail.section.checkoutSales')" > <sw-card-section> <mt-select v-model="item.checkoutSales" :label="$t('rhae-tweakwise-frontend.detail.label.checkoutSales')" :options="checkoutSalesTypes" /> <sw-text-field :label="$t('rhae-tweakwise-frontend.detail.label.checkoutSalesFeaturedProductsId')" v-if="item.checkoutSales === 'featured-products'" v-model:value="item.checkoutSalesFeaturedProductsId" ></sw-text-field> <sw-text-field :label="$t('rhae-tweakwise-frontend.detail.label.checkoutSalesRecommendationsGroupKey')" v-if="item.checkoutSales === 'recommendations'" v-model:value="item.checkoutSalesRecommendationsGroupKey" ></sw-text-field> </sw-card-section> </sw-card> {% block sw_tweakwise_feed_detail_backendsync %} <sw-card v-if="validToken" :isLoading="isLoading" :title="$tc('rhae-tweakwise-frontend.detail.section.backendSync')" > {% block sw_tweakwise_feed_detail_backendsync_beta %} <mt-banner variant="attention" showIcon > <div v-html="$t('rhae-tweakwise-frontend.detail.info.backendSyncBeta')"></div> </mt-banner> {% endblock %} <p>{{ $t('rhae-tweakwise-frontend.detail.info.backendSync') }}</p> <sw-card-section> {% block sw_tweakwise_feed_detail_backendsync_enable_switch %} <mt-switch v-model="item.backendSyncEnabled" :label="$tc('rhae-tweakwise-frontend.detail.label.backendSyncEnabled')" /> {% endblock %} {% block sw_tweakwise_feed_detail_backendsync_options %} <div v-if="item.backendSyncEnabled && backendSyncOptions" class="backendSyncOptions"> <h4>{{ $t('rhae-tweakwise-frontend.detail.section.backendSyncMain') }}</h4> <sw-container columns="2fr 2fr 2fr" gap="0px 30px" > <div v-if="!backendSyncOptions['main'] || backendSyncOptions['main'].length === 0"> Geen opties </div> <sw-checkbox-field v-for="(label, option) in backendSyncOptions['main']" :name="option" :checked="isChecked('main', option)" @update:value="setSelectedProperty($event, option, 'main')" :label="$tc('rhae-tweakwise-frontend.detail.label.backendSyncOptions.main.' + label)" /> </sw-container> <h4>{{ $t('rhae-tweakwise-frontend.detail.section.backendSyncProperties') }}</h4> <sw-container columns="2fr 2fr 2fr" gap="0px 30px" > <div v-if="!backendSyncOptions['properties'] || backendSyncOptions['properties'].length === 0"> Geen opties </div> <sw-checkbox-field v-for="(label, option) in backendSyncOptions['properties']" :name="option" :checked="isChecked('properties', option)" @update:value="setSelectedProperty($event, option, 'properties')" :label="label" /> </sw-container> <h4>{{ $t('rhae-tweakwise-frontend.detail.section.backendSyncCustomFields') }}</h4> <sw-container columns="2fr 2fr 2fr" gap="0px 30px" > <div v-if="!backendSyncOptions['customFields'] || backendSyncOptions['customFields'].length === 0"> Geen opties </div> <sw-checkbox-field v-for="(label, option) in backendSyncOptions['customFields']" :name="option" :checked="isChecked('customFields', option)" @update:value="setSelectedProperty($event, option, 'customFields')" :label="label" /> </sw-container> </div> {% endblock %} </sw-card-section> </sw-card> {% endblock %} </sw-card-view> </template> </sw-page>`,{Component:te}=Shopware;te.extend("rhae-tweakwise-frontend-create","rhae-tweakwise-frontend-detail",{template:k,methods:{getItem(){this.item=this.repository.create(Shopware.Context.api),this.isLoading=!1},onClickSave(){this.isLoading=!0,this.repository.save(this.item,Shopware.Context.api).then(()=>{this.isLoading=!1,this.$router.push({name:"rhae.tweakwise.frontend.detail",params:{id:this.item.id}})}).catch(e=>{this.isLoading=!1,this.createNotificationError({title:this.$tc("rhae-tweakwise.notification.errorTitle"),message:e})})}}});const{Component:ie,Mixin:ae,Context:c}=Shopware,{EntityCollection:se,Criteria:h}=Shopware.Data,{mapPropertyErrors:fe}=Shopware.Component.getComponentHelper();ie.register("rhae-tweakwise-frontend-detail",{template:k,inject:["repositoryFactory","context"],mixins:[ae.getByName("notification")],metaInfo(){return{title:this.$createTitle()}},data(){return{item:null,salesChannelDomains:null,isLoading:!1,validToken:!1,tokenError:null,suggestionsAvailable:!1,recommendationsAvailable:!1,processSuccess:!1,salesChannelDomainIds:[],backendSyncOptions:[]}},computed:{integrationTypes(){return[{id:1,value:"no-integration",label:this.$tc("rhae-tweakwise-frontend.detail.label.integrationOptions.no-integration")},{id:2,value:"pluginstudio",label:this.$tc("rhae-tweakwise-frontend.detail.label.integrationOptions.pluginstudio")},{id:3,value:"javascript",label:this.$tc("rhae-tweakwise-frontend.detail.label.integrationOptions.javascript")}]},wayOfSearchTypes(){return this.suggestionsAvailable?[{id:1,value:"instant-search",label:this.$tc("rhae-tweakwise-frontend.detail.label.wayOfSearchOptions.instant-search")},{id:2,value:"suggestions",label:this.$tc("rhae-tweakwise-frontend.detail.label.wayOfSearchOptions.suggestions")}]:[{id:1,value:"instant-search",label:this.$tc("rhae-tweakwise-frontend.detail.label.wayOfSearchOptions.instant-search")}]},checkoutSalesTypes(){return[{id:1,value:"no-checkout-sales",label:this.$tc("rhae-tweakwise-frontend.detail.label.checkoutSalesOptions.no-checkout-sales")},{id:2,value:"featured-products",label:this.$tc("rhae-tweakwise-frontend.detail.label.checkoutSalesOptions.featured-products")},{id:3,value:"recommendations",label:this.$tc("rhae-tweakwise-frontend.detail.label.checkoutSalesOptions.recommendations")}]},repository(){return this.repositoryFactory.create("s_plugin_rhae_tweakwise_frontend")},salesChannelDomainRepository(){return this.repositoryFactory.create("sales_channel_domain")},salesChannelDomainIds:{get(){return this.salesChannelDomainIds||[]},set(e){this.salesChannelDomainIds={...this.salesChannelDomainIds,salesChannelDomainIds:e}}},defaultCriteria(){return new h}},created(){this.getItem(),this.getSalesChannelDomains(),this.getBackendSyncOptions()},methods:{async getBackendSyncOptions(){this.isLoading=!0;const t={headers:{Authorization:`Bearer ${Shopware.Service("loginService").getToken()}`}},n=await Shopware.Application.getContainer("init").httpClient.get("/_action/rhae-tweakwise/sync-options",t);n.status!==200||(this.backendSyncOptions=n.data),this.isLoading=!1},isChecked(e,t){var i;return!!((i=this.item)!=null&&i.backendSyncProperties&&this.item.backendSyncProperties[e]&&this.item.backendSyncProperties[e][t])},async checkPossibilities(){if(this.validToken=!1,this.suggestionsAvailable=!1,this.recommendationsAvailable=!1,this.item.token)try{this.isLoading=!0;const e=Shopware.Application.getContainer("init").httpClient,t={headers:{Authorization:`Bearer ${Shopware.Service("loginService").getToken()}`}},i=await e.get("/_action/rhae-tweakwise/check-possibilities/"+this.item.token,t);this.validToken=i.data.validToken===!0,this.suggestionsAvailable=i.data.features.suggestions===!0,this.recommendationsAvailable=i.data.features.recommendations===!0}catch{}finally{this.tokenError=null,this.validToken||(this.tokenError={detail:this.$tc("rhae-tweakwise-frontend.notification.tokenError")}),this.isLoading=!1}},getSalesChannelDomains(){this.salesChannelDomains=new se(this.salesChannelDomainRepository.route,this.salesChannelDomainRepository.entityName,c.api)},getItem(){var e=new h;e.addAssociation("salesChannelDomains"),this.repository.get(this.$route.params.id,c.api,e).then(t=>{this.item=t,this.checkPossibilities(),(!this.item.backendSyncProperties||Array.isArray(this.item.backendSyncProperties))&&(this.item.backendSyncProperties={}),["main","properties","customFields"].forEach(a=>{(!this.item.backendSyncProperties[a]||Array.isArray(this.item.backendSyncProperties[a]))&&(this.item.backendSyncProperties[a]={})})})},onChangeValue(e,t,i=!0){this.item[t]=e,this.$emit("change-value",t,e)},setSelectedProperty(e,t,i,a=!0){(!this.item.backendSyncProperties||Array.isArray(this.item.backendSyncProperties))&&(this.item.backendSyncProperties={}),(!this.item.backendSyncProperties[i]||Array.isArray(this.item.backendSyncProperties[i]))&&(this.item.backendSyncProperties[i]={}),this.item.backendSyncProperties[i][String(t)]=!!e,this.$emit("change-value",t,e)},ensureOptionKeysExist(){["main","properties","customFields"].forEach(t=>{var a;this.item.backendSyncProperties[t]||this.$set(this.item.backendSyncProperties,t,{}),(((a=this.backendSyncOptions)==null?void 0:a[t])||[]).forEach(n=>{typeof this.item.backendSyncProperties[t][n]>"u"&&this.$set(this.item.backendSyncProperties[t],n,!1)})})},onChangeToggle(e,t){this.onChangeValue(e,t,!1)},async onClickSave(){this.isLoading=!0;try{await this.repository.save(this.item,c.api),await this.getItem(),this.processSuccess=!0}catch(e){this.createNotificationError({title:this.$tc("rhae-tweakwise-frontend.notification.errorTitle"),message:e})}finally{this.isLoading=!1}},setSalesChannelDomains(e){this.salesChannelDomains=e,this.item.salesChannelDomains=e},saveFinish(){this.processSuccess=!1}}});const ne={"rhae-tweakwise-frontend":{main:{menuLabel:"Tweakwise frontend",menuDescription:"Configureer je Tweakwise frontend"},list:{addButtonText:"Maak nieuwe frontend",refreshButtonText:"Vernieuwen",columns:{name:"Frontend naam"}},notification:{tokenError:"Ongeldige instance key opgegeven"},detail:{cancelButtonText:"Annuleren",saveButtonText:"Opslaan",section:{main:"Algemeen",data:"Data",checkoutSales:"Kassakoopjes",search:"Zoeken",merchandise:"Listerpagina's",backendSync:"Backend synchronisatie",backendSyncMain:"Algemene eigenschappen",backendSyncProperties:"Overige eigenschappen",backendSyncCustomFields:"Vrije tekstvelden"},info:{backendSync:"Wanneer deze optie is geactiveerd, krijg je de mogelijkheid om een product direct te synchroniseren met Tweakwise op de product pagina in de Shopware admin"},label:{name:"Naam",token:"Instance key",accessToken:"Access token",integration:"Manier van integreren",integrationOptions:{"no-integration":"Geen integratie",javascript:"JavaScript integratie",pluginstudio:"Plugin Studio implementatie"},eventTagEnabled:"Activeer geavanceerde analytics (bijv. voor personalisatie)",wayOfSearch:"Manier van zoeken",wayOfSearchOptions:{"instant-search":"Direct zoeken",suggestions:"Suggesties + aparte zoekpagina"},checkoutSales:"Kassakoopjes",checkoutSalesOptions:{"no-checkout-sales":"Geen kassakoopjes","featured-products":"Toon uitgelichte producten",recommendations:"Toon aanbevelingen gebaseerd op het laatst toegevoegde product"},backendSyncOptions:{main:{name:"Naam",unitPrice:"Prijs per stuk",availableStock:"Beschikbare voorraad",manufacturer:"Fabrikant"}},fullPathCid:"Laat categorieÃ«n met dezelfde bovenliggende categorie zien bij categorie filters",checkoutSalesFeaturedProductsId:"Uitgelichte producten ID",checkoutSalesRecommendationsGroupKey:"Groep sleutel gebruikt voor cross-sell",salesChannelDomains:"Domeinen",backendSyncEnabled:"Activeer backend synchronisatie",productsDesktop:"Aantal producten per rij op desktop",productsTablet:"Aantal producten per rij op tablet",productsMobile:"Aantal producten per rij op mobiel",paginationType:"Type paginering",paginationTypeOptions:{default:"Standaard",button:"Knop",infinite:"Oneindig"}}}}},oe={"rhae-tweakwise-frontend":{main:{menuLabel:"Tweakwise",menuDescription:"Configure your Tweakwise instances"},list:{addButtonText:"Add new instance",refreshButtonText:"Refresh",columns:{name:"Instance"}},notification:{tokenError:"Invalid instance key given"},detail:{cancelButtonText:"Cancel",saveButtonText:"Save",section:{main:"General",data:"Data",checkoutSales:"Checkout sales",search:"Search",merchandise:"Merchandising",backendSync:"Backend Sync",backendSyncMain:"Main properties",backendSyncProperties:"Additional properties",backendSyncCustomFields:"Custom fields"},info:{backendSync:"If enabled, you get the possibility to sync a product with Tweakwise from the product page in the admin of Shopware. This way you can sync a specific product right away.",backendSyncBeta:"<strong>Experimental feature:</strong> Please reach out to us in case you encounter unexpected behaviour."},label:{name:"Name",token:"Instance key",accessToken:"Access token",integration:"Way of integration",integrationOptions:{"no-integration":"No integration",javascript:"JavaScript implementation",pluginstudio:"Plugin Studio implementation"},eventTagEnabled:"Enable advanced analytics (e.g., for personalization)",wayOfSearch:"Way of search",wayOfSearchOptions:{"instant-search":"Instant search",suggestions:"Suggestions + Dedicated search page"},checkoutSales:"Checkout sales",checkoutSalesOptions:{"no-checkout-sales":"No checkout sales","featured-products":"Show featured products",recommendations:"Show recommendations based on last item in cart"},backendSyncOptions:{main:{name:"Name",unitPrice:"Unit price",availableStock:"Available stock",manufacturer:"Manufacturer",url:"Url",images:"Images",categories:"Categories"}},fullPathCid:"Show sibling categories in category filtering",checkoutSalesFeaturedProductsId:"Featured recommendation ID",checkoutSalesRecommendationsGroupKey:"Group key used for cross-sell",salesChannelDomains:"Domains",backendSyncEnabled:"Enable backend synchronisation",productsDesktop:"Products per row on desktop",productsTablet:"Products per row on tablet",productsMobile:"Products per row on mobile",paginationType:"Type of pagination",paginationTypeOptions:{default:"Default",button:"Button",infinite:"Infinite"}}}}};Shopware.Module.register("rhae-tweakwise-frontend",{type:"plugin",name:"Tweakwise frontend",title:"rhae-tweakwise-frontend.main.menuLabel",description:"rhae-tweakwise-frontend.main.menuDescription",color:"#028eca",snippets:{"nl-NL":ne,"en-GB":oe},routes:{list:{component:"rhae-tweakwise-frontend-list",path:"list",meta:{parentPath:"sw.settings.index.plugins"}},detail:{component:"rhae-tweakwise-frontend-detail",path:"detail/:id",meta:{parentPath:"rhae.tweakwise.frontend.list"}},create:{component:"rhae-tweakwise-frontend-create",path:"create",meta:{parentPath:"rhae.tweakwise.frontend.list"}}},settingsItem:{name:"rhae-tweakwise-frontend-list",to:"rhae.tweakwise.frontend.list",label:"rhae-tweakwise-frontend.main.menuLabel",group:"plugins",iconComponent:"rhae-tweakwise-settings-icon"}});const re=`{% block sw_cms_sidebar_block_overview_category_options %} {% block sw_cms_sidebar_block_overview_category_tweakwise %} <option value="tweakwise"> {{ $tc('sw-cms.component.sw-cms-sidebar.blockTweakwise') }} </option> {% endblock %} {% parent() %} {% endblock %}`,{Component:le}=Shopware;le.override("sw-cms-sidebar",{template:re});
//# sourceMappingURL=rhae-tweakwise-DDYJLtqx.js.map
